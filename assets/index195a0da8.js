var v=Object.defineProperty;var P=(t,e,o)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var m=(t,e,o)=>(P(t,typeof e!="symbol"?e+"":e,o),o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const l=(t,e)=>t.querySelector(e),R=t=>{for(;t.lastChild;)t.removeChild(t.lastChild)};async function k(t,e,o,i,s){try{let r;if(s?r=await fetch(t,s):r=await fetch(t),!r.ok)throw{status:r.status,statusText:r.statusText};let n;e==="text"&&(n=await r.text()),e==="blob"&&(n=await r.blob()),e==="json"&&(n=await r.json()),o(n)}catch(r){i(r)}}function M(t,e,o){let i=document.createElement(o);i.textContent=`Error ${t.status||t.name||"Unknown"}: ${t.statusText||t.cause||"An error has ocured while fetching the URI"}`,i.classList.add("fetchErrHandlerError"),e.appendChild(i)}class A{constructor(e){m(this,"DOMAIN");m(this,"URI");m(this,"API_WP");m(this,"resources",{});this.DOMAIN=e,this.URI=`${e}/wp-json`,this.API_WP=`${this.URI}/wp/v2`}get getDOMAIN(){return this.DOMAIN}get getURI(){return this.URI}get getAllResources(){return this.resources}setUpdateResource(e,o){this.resources[e]=`${this.API_WP}${o}`}getResource(e){return this.resources[e]}deleteResource(e){delete this.resources[e]}}const u=document,_=document.querySelector("#WP-form"),I=u.querySelector("#site"),y=u.querySelector("#posts"),$=u.querySelector(".post-loader"),b=u.querySelector(".site-loader"),C=u.querySelector("#post-template"),E=u.createDocumentFragment(),a=C.content;let w=new IntersectionObserver(()=>{},{});function S(t){k(t.getURI,"json",e=>{b.style.display="block",I.innerHTML=`
      <h3>Sitio Web</h3>
      <h2>
        <a href="${e.url}" target="_blank" rel="noopener">${e.name}</a>
      </h2>
      <p>${e.description}</p>
      <p>${e.timezone_string}</p>
      `,b.style.display="none"},e=>{console.error(e),M(e,I,"h2"),b.style.display="none"})}document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("submit",async t=>{if(t.target===_){t.preventDefault(),I.innerHTML!==""&&R(I),y.innerHTML!==""&&R(y),b.style.display="block",$.style.display="block";const e=_.link.value;e===""&&w.disconnect();const o=new A(e);o.setUpdateResource("posts","/posts?_embed&per_page=4"),S(o);const i=async n=>{try{let d=await fetch(n);if(!d.ok)throw{status:d.status,statusText:d.statusText};let T=await d.json();$.style.display="block",T.forEach(c=>{let p="",h="",g=c._embedded["wp:term"];g[0].length===0?p+="<p>(No categories)</p>":g[0].forEach(f=>p.includes(f)?p+="":p+=`<li>${f.name}</li>`),g[1].length===0?h+="<p>(No tags)</p>":g[1].forEach(f=>h.includes(f)?h+="":h+=`<li>${f.name}</li>`);let x=c._embedded["wp:featuredmedia"][0];l(a,".post-image").src=x.source_url||c.jetpack_featured_media_url,l(a,".post-image").alt=x.alt_text||"Post image not found",l(a,".post-title").textContent=c.title.rendered;let L=c._embedded.author[0];l(a,".post-author").innerHTML=`
                <img 
                src="${L.avatar_urls[48]}" 
                alt="${L.name}" >
                <figcaption>${L.name}</figcaption>
              `,l(a,".post-date").textContent=new Date(c.date||"--/--/--").toLocaleString(),l(a,".post-link").href=c.link,l(a,".post-excerpt").innerHTML=c.excerpt.rendered.replace("[&hellip;]","..."),l(a,".post-categories").innerHTML=`
              <p>Categor\xEDas:</p><ul>${p}</ul>`,l(a,".post-tags").innerHTML=`
              <p>Etiquetas:</p><ul>${h}</ul>`,l(a,".post-content > article").innerHTML=c.content.rendered,E.appendChild(u.importNode(a,!0))}),y.appendChild(E)}catch(d){M(d,y,"h2"),console.error(d),$.style.display="none"}},s=(()=>{let n=2;return()=>(n+=1,n)})(),r=async n=>{n[0].isIntersecting&&(o.setUpdateResource("posts",`/posts?_embed&per_page=4&page=${s()}`),await i(o.getResource("posts")))};w=new IntersectionObserver(r,{root:null,threshold:1,rootMargin:"740px 0px"}),u.addEventListener("change",()=>w.disconnect()),await i(o.getResource("posts")),w.observe($),_.reset()}})});
