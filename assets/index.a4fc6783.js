var R=Object.defineProperty;var T=(t,e,s)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var f=(t,e,s)=>(T(t,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const u=document,m=u.querySelector("#site"),g=u.querySelector("#posts"),c=u.querySelector(".loader"),L=c.querySelector("h2"),k=u.querySelector("#post-template"),w=u.createDocumentFragment(),P=k.content,a=t=>P.querySelector(t),b=t=>{for(;t.lastChild;)t.removeChild(t.lastChild)};async function C(t,e,s,i,r){try{let o;if(r?o=await fetch(t,r):o=await fetch(t),!o.ok)throw{status:o.status,statusText:o.statusText};let n;e==="text"&&(n=await o.text()),e==="blob"&&(n=await o.blob()),e==="json"&&(n=await o.json()),s(n)}catch(o){o&&i(o)}}function _(t,e,s){let i=document.createElement(s);i.textContent=`Error ${t.status||t.name||"Unknown"}: ${t.statusText||t.message||"An error has occurred while fethcing the URI"}`,e.appendChild(i)}class v{constructor(e){f(this,"DOMAIN");f(this,"URI");f(this,"API_WP");f(this,"resources",{});this.DOMAIN=e,this.URI=`${e}/wp-json`,this.API_WP=`${this.URI}/wp/v2`}get getURI(){return this.URI}get getAllResources(){return this.resources}setUpdateResource(e,s){this.resources[e]=`${this.API_WP}${s}`}getResource(e){return this.resources[e]}deleteResource(e){delete this.resources[e]}}function M(t,e){let s=2;const i=(()=>{let n=2;return()=>(n+=1,n)})(),r=n=>{n.forEach(l=>{l.isIntersecting&&(e(s),s=i())})};new IntersectionObserver(r,{root:null,threshold:1,rootMargin:"730px 0px"}).observe(t)}function x(t){const e=new v(t);C(e.getURI,"json",s=>{c.style.display="block",m.innerHTML=`
      <h3>Sitio Web</h3>
      <h2>
        <a href="${s.url}" target="_blank" rel="noopener">${s.name}</a>
      </h2>
      <p>${s.description}</p>
      <p>${s.timezone_string}</p>
      `,L.textContent="Loading posts..."},s=>{console.error(s),s&&_(s,m,"h2"),c.style.display="none"})}async function I(t){const e=new v(t);e.setUpdateResource("posts","/posts?_embed&per_page=4");const s=async i=>{try{let r=await fetch(i);if(!r.ok)throw{status:r.status,statusText:r.statusText};let o=await r.json();L.textContent="Loading pots...",c.style.display="block",o.forEach(n=>{let l="",d="",h=n._embedded["wp:term"];h[0].length===0?l+="<p>(No categories)</p>":h[0].forEach(p=>l.includes(p)?l+="":l+=`<li>${p.name}</li>`),h[1].length===0?d+="<p>(No tags)</p>":h[1].forEach(p=>d.includes(p)?d+="":d+=`<li>${p.name}</li>`);let $=n._embedded["wp:featuredmedia"][0];a(".post-image").src=$.source_url||n.jetpack_featured_media_url,a(".post-image").alt=$.alt_text||"Post image not found",a(".post-title").textContent=n.title.rendered;let y=n._embedded.author[0];a(".post-author").innerHTML=`
            <img 
            src="${y.avatar_urls[48]}" 
            alt="${y.name}" >
            <figcaption>${y.name}</figcaption>
          `,a(".post-date").textContent=new Date(n.date||"--/--/--").toLocaleString(),a(".post-link").href=n.link,a(".post-excerpt").innerHTML=n.excerpt.rendered.replace("[&hellip;]","..."),a(".post-categories").innerHTML=`
          <p>Categor\xEDas:</p><ul>${l}</ul>`,a(".post-tags").innerHTML=`
          <p>Etiquetas:</p><ul>${d}</ul>`,a(".post-content > article").innerHTML=n.content.rendered,w.appendChild(u.importNode(P,!0))}),g.appendChild(w)}catch(r){r&&_(r,g,"h2"),console.error(r),c.style.display="none"}};await s(e.getResource("posts")),M(c,i=>{e.setUpdateResource("posts",`/posts?_embed&per_page=4&page=${i}`),s(e.getResource("posts"))})}document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("submit",t=>{const e=document.querySelector("#WP-form");t.target===e&&(t.preventDefault(),c.style.display="block",m.innerHTML===""||g.innerHTML===""?(x(e.link.value),I(e.link.value)):(b(m),b(g),x(e.link.value),I(e.PostForm.link.value)),e.reset())})});
